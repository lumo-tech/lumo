<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lumo.trainer package &mdash; lumo 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            lumo
          </a>
              <div class="version">
                
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial/getting_start.html">Getting Start</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lumo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">lumo.trainer package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/lumo.trainer.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lumo-trainer-package">
<h1>lumo.trainer package<a class="headerlink" href="#lumo-trainer-package" title="Permalink to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="lumo.trainer.backend.html">lumo.trainer.backend package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lumo.trainer.backend.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="lumo.trainer.backend.html#module-lumo.trainer.backend.accelerator">lumo.trainer.backend.accelerator module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lumo.trainer.backend.html#lumo.trainer.backend.accelerator.Accelerator"><code class="docutils literal notranslate"><span class="pre">Accelerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="lumo.trainer.backend.html#lumo.trainer.backend.accelerator.Accelerator.prepare_data_loader"><code class="docutils literal notranslate"><span class="pre">Accelerator.prepare_data_loader()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lumo.trainer.backend.html#module-lumo.trainer.backend">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-lumo.trainer.accelerator">
<span id="lumo-trainer-accelerator-module"></span><h2>lumo.trainer.accelerator module<a class="headerlink" href="#module-lumo.trainer.accelerator" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.accelerator.</span></span><span class="sig-name descname"><span class="pre">Accelerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to define the interface for various types of accelerator.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator._prop">
<span class="sig-name descname"><span class="pre">_prop</span></span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator._prop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A dictionary of keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.device">
<span class="sig-name descname"><span class="pre">device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A property method to get the device.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.set_device">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.set_device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to set the device.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.prepare_data_loader">
<span class="sig-name descname"><span class="pre">prepare_data_loader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.prepare_data_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the data loader.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.prepare_model">
<span class="sig-name descname"><span class="pre">prepare_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.prepare_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.prepare_optimizer">
<span class="sig-name descname"><span class="pre">prepare_optimizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.prepare_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the optimizer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.unwrap_model">
<span class="sig-name descname"><span class="pre">unwrap_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.unwrap_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to unwrap the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.prepare" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the inputs for training.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.wait_for_everyone">
<span class="sig-name descname"><span class="pre">wait_for_everyone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.wait_for_everyone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to wait for all processes to synchronize.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.gather">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.gather" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to gather the tensor data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.Accelerator.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.Accelerator.backward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to compute the gradients using backpropagation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the gradients using backpropagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<em>torch.Tensor</em>) – The loss tensor.</p></li>
<li><p><strong>**kwargs</strong> – <p>The additional keyword arguments.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">device</span></em><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the device.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Permalink to this definition">¶</a></dt>
<dd><p>Gather the tensor data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>torch.Tensor</em>) – The tensor to be gathered.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gathered tensor data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id5" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the inputs for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>The inputs.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">prepare_data_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id8" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the data loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataloader</strong> – The data loader.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">prepare_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id9" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>torch.nn.Module</em>) – The model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">prepare_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id10" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – The optimizer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared optimizer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id11" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em>) – The device to be set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">unwrap_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id12" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> – The model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unwrapped model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">wait_for_everyone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id13" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for all processes to synchronize.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.accelerator.</span></span><span class="sig-name descname"><span class="pre">HugAccelerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.accelerator.Accelerator" title="lumo.trainer.accelerator.Accelerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Accelerator</span></code></a></p>
<p>A class to define the interface for Hugging Face accelerator.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.set_device">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.set_device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to set the device.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.prepare_data_loader">
<span class="sig-name descname"><span class="pre">prepare_data_loader</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.prepare_data_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the data loader.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.prepare_model">
<span class="sig-name descname"><span class="pre">prepare_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.prepare_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.prepare_optimizer">
<span class="sig-name descname"><span class="pre">prepare_optimizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.prepare_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the optimizer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.unwrap_model">
<span class="sig-name descname"><span class="pre">unwrap_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.unwrap_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to unwrap the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.prepare" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to prepare the inputs for training.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.wait_for_everyone">
<span class="sig-name descname"><span class="pre">wait_for_everyone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.wait_for_everyone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to wait for all processes to synchronize.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.gather">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.gather" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to gather the tensor data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.backward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>A method to compute the gradients using backpropagation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id14" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the gradients using backpropagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<em>torch.Tensor</em>) – The loss tensor.</p></li>
<li><p><strong>**kwargs</strong> – <p>The additional keyword arguments.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.HugAccelerator.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#lumo.trainer.accelerator.HugAccelerator.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the device.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id17" title="Permalink to this definition">¶</a></dt>
<dd><p>Gather the tensor data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> – The tensor to be gathered.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gathered tensor data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id18" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the inputs for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – <p>The inputs.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">prepare_data_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id21" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the data loader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loader</strong> – The data loader.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared data loader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">prepare_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id22" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> – The model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">prepare_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id23" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare the optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimizer</strong> – The optimizer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared optimizer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">set_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id24" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em>) – The device to be set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">unwrap_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id25" title="Permalink to this definition">¶</a></dt>
<dd><p>Unwrap the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> – The model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unwrapped model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">wait_for_everyone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id26" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for all processes to synchronize.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lumo.trainer.accelerator.get_accelerator">
<span class="sig-prename descclassname"><span class="pre">lumo.trainer.accelerator.</span></span><span class="sig-name descname"><span class="pre">get_accelerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#lumo.trainer.accelerator.Accelerator" title="lumo.trainer.accelerator.Accelerator"><span class="pre">Accelerator</span></a></span></span><a class="headerlink" href="#lumo.trainer.accelerator.get_accelerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the accelerator for the specified name.</p>
</dd></dl>

</section>
<section id="module-lumo.trainer.base">
<span id="lumo-trainer-base-module"></span><h2>lumo.trainer.base module<a class="headerlink" href="#module-lumo.trainer.base" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-lumo.trainer.callbacks">
<span id="lumo-trainer-callbacks-module"></span><h2>lumo.trainer.callbacks module<a class="headerlink" href="#module-lumo.trainer.callbacks" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.AutoLoadModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">AutoLoadModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.AutoLoadModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.InitialCallback" title="lumo.trainer.callbacks.InitialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">InitialCallback</span></code></a></p>
<p>Callback to automatically load pretrained model.</p>
<p>The load function will be executed if and only if</p>
<ul class="simple">
<li><p>both the params <code class="docutils literal notranslate"><span class="pre">pretrain</span></code> and <code class="docutils literal notranslate"><span class="pre">pretrain_path</span></code> are defined in ParamsType</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pretrain</span></code> is True and <code class="docutils literal notranslate"><span class="pre">pretrain_path</span></code> is not None.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.AutoLoadModel.on_imodels_end">
<span class="sig-name descname"><span class="pre">on_imodels_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.AutoLoadModel.on_imodels_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">BaseCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class used to build new callbacks.</p>
<p>Callbacks are created to hook into the various stages of lumo’s Trainer training, inference or data preparing.
You can hook any subclasses of <code class="docutils literal notranslate"><span class="pre">BaseCallback</span></code> in <code class="docutils literal notranslate"><span class="pre">lumo.trainer.trainer.Trainer</span></code> class.</p>
<p>To create a custom callback class, subclass <code class="docutils literal notranslate"><span class="pre">lumo.trainer.callbacks.BaseCallback</span></code>, and define the callback methods
you want to do something before or after that.</p>
<p>The callback method must be named like on_xxx_begin()/on_xxx_end(), where <code class="docutils literal notranslate"><span class="pre">xxx</span></code> is a function in trainer.</p>
<p>TrainCallback, SaveLoadCallback and InitialCallback define the most methods in Trainer, you can simply subclass these
callback class to custom your callback.</p>
<p class="rubric">Notes</p>
<p>There is no need for you to call the on_xxx function in your function’s logic.</p>
<p>The Trainer has some magic feature… not like keras or other framework with trainer/callback logic that
you may need to manully call the callback function <code class="docutils literal notranslate"><span class="pre">on_xxx...()</span></code> in you overrided or newly defined method in Trainer,
If you define a function <code class="docutils literal notranslate"><span class="pre">foo()</span></code> in your trainer, the callback function on_foo_begin() and on_foo_end() will be found
automatically and be called, There is no need for you to call them in your function’s logic.</p>
<p class="rubric">Examples</p>
<p>{{examples/docs/basecallback.py}}</p>
<p>{{examples/docs/basecallback2.py}}</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.getfuncargs">
<span class="sig-name descname"><span class="pre">getfuncargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.getfuncargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.hook">
<span class="sig-name descname"><span class="pre">hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.hook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.on_begin">
<span class="sig-name descname"><span class="pre">on_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.on_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>called before trainer.func is called</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.on_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.on_exception">
<span class="sig-name descname"><span class="pre">on_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>called when exception raised in some function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.on_first_exception">
<span class="sig-name descname"><span class="pre">on_first_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.on_first_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>when an exception was raised in some function, on_exception() will be called.</p>
<p>如果异常发生在一个嵌套调用的函数中，那么该异常会在每一层函数都raise一次。</p>
<p>该方法将被调用当该异常第一次raise出来的时候。
该方法在 <strong>new</strong> 中作了处理逻辑，不受继承关系影响</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.on_hook_failed">
<span class="sig-name descname"><span class="pre">on_hook_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.on_hook_failed" title="Permalink to this definition">¶</a></dt>
<dd><p>Any reason when callback cannot hook on trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.only_main_process">
<span class="sig-name descname"><span class="pre">only_main_process</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.only_main_process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.only_single_gpu">
<span class="sig-name descname"><span class="pre">only_single_gpu</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.only_single_gpu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.priority">
<span class="sig-name descname"><span class="pre">priority</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.priority" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.BaseCallback.unhook">
<span class="sig-name descname"><span class="pre">unhook</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.BaseCallback.unhook" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">DebugCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.BaseCallback" title="lumo.trainer.callbacks.BaseCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback.on_begin">
<span class="sig-name descname"><span class="pre">on_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback.on_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>called before trainer.func is called</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback.on_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback.on_exception">
<span class="sig-name descname"><span class="pre">on_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback.on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>called when exception raised in some function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback.on_first_exception">
<span class="sig-name descname"><span class="pre">on_first_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback.on_first_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>when an exception was raised in some function, on_exception() will be called.</p>
<p>如果异常发生在一个嵌套调用的函数中，那么该异常会在每一层函数都raise一次。</p>
<p>该方法将被调用当该异常第一次raise出来的时候。
该方法在 <strong>new</strong> 中作了处理逻辑，不受继承关系影响</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback.on_hook_failed">
<span class="sig-name descname"><span class="pre">on_hook_failed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback.on_hook_failed" title="Permalink to this definition">¶</a></dt>
<dd><p>Any reason when callback cannot hook on trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.DebugCallback.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.DebugCallback.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EMAUpdate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">EMAUpdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EMAUpdate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a></p>
<p>Callback to update EMA model every train step.</p>
<p>Variable in Trainer instance is identified as EMA model when</p>
<ul class="simple">
<li><p>is instance of torch.nn.Module</p></li>
<li><p>name is started with ‘ema’</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EMAUpdate.on_train_step_end">
<span class="sig-name descname"><span class="pre">on_train_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EMAUpdate.on_train_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">EvalCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EvalCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a></p>
<p>Callback for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_per_epoch</strong> – </p></li>
<li><p><strong>test_per_epoch</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalCallback.has_eval">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_eval</span></span><a class="headerlink" href="#lumo.trainer.callbacks.EvalCallback.has_eval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalCallback.has_test">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_test</span></span><a class="headerlink" href="#lumo.trainer.callbacks.EvalCallback.has_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalCallback.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EvalCallback.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalCallback.on_train_epoch_end">
<span class="sig-name descname"><span class="pre">on_train_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EvalCallback.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalFirst">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">EvalFirst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EvalFirst" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.AutoLoadModel" title="lumo.trainer.callbacks.AutoLoadModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">AutoLoadModel</span></code></a></p>
<p>Callback to evaluation before the first train step. Aften used to debug or evaluate some dataset by restored model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.EvalFirst.on_imodels_end">
<span class="sig-name descname"><span class="pre">on_imodels_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.meter.Meter" title="lumo.core.meter.Meter"><span class="pre">Meter</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.EvalFirst.on_imodels_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">InitialCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.BaseCallback" title="lumo.trainer.callbacks.BaseCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCallback</span></code></a></p>
<p>Abstract base class used to build new callbacks. Defined some methods used in save/load.</p>
<p>Subclass InitialCallback if you want to control or add behavior before or after
- initialization of optims/models/dataloader</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_imodels_begin">
<span class="sig-name descname"><span class="pre">on_imodels_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_imodels_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_imodels_end">
<span class="sig-name descname"><span class="pre">on_imodels_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_imodels_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_prepare_dataloader_begin">
<span class="sig-name descname"><span class="pre">on_prepare_dataloader_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_prepare_dataloader_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_prepare_dataloader_end">
<span class="sig-name descname"><span class="pre">on_prepare_dataloader_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_prepare_dataloader_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_process_loader_begin">
<span class="sig-name descname"><span class="pre">on_process_loader_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_process_loader_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_process_loader_end">
<span class="sig-name descname"><span class="pre">on_process_loader_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_process_loader_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_regist_dataloader_begin">
<span class="sig-name descname"><span class="pre">on_regist_dataloader_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_regist_dataloader_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.InitialCallback.on_regist_dataloader_end">
<span class="sig-name descname"><span class="pre">on_regist_dataloader_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.InitialCallback.on_regist_dataloader_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">LoggerCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a>, <a class="reference internal" href="#lumo.trainer.callbacks.InitialCallback" title="lumo.trainer.callbacks.InitialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">InitialCallback</span></code></a></p>
<p>A callback for logging the training process.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.flush">
<span class="sig-name descname"><span class="pre">flush</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.format_interval">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">format_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.format_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats a number of seconds as a clock time, [H:]MM:SS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<em>int</em>) – Number of seconds.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – [H:]MM:SS</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.format_train_epoch_time">
<span class="sig-name descname"><span class="pre">format_train_epoch_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elapsed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'it'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bar_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postfix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_divisor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">extra_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.format_train_epoch_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Format</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_eval_begin">
<span class="sig-name descname"><span class="pre">on_eval_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_eval_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_eval_end">
<span class="sig-name descname"><span class="pre">on_eval_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_eval_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_eval_step_end">
<span class="sig-name descname"><span class="pre">on_eval_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_eval_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_imodels_end">
<span class="sig-name descname"><span class="pre">on_imodels_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_imodels_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_process_loader_end">
<span class="sig-name descname"><span class="pre">on_process_loader_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoaderType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_process_loader_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_test_begin">
<span class="sig-name descname"><span class="pre">on_test_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_test_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_test_end">
<span class="sig-name descname"><span class="pre">on_test_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_test_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_test_step_end">
<span class="sig-name descname"><span class="pre">on_test_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_test_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_train_epoch_begin">
<span class="sig-name descname"><span class="pre">on_train_epoch_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_train_epoch_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_train_epoch_end">
<span class="sig-name descname"><span class="pre">on_train_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.on_train_step_end">
<span class="sig-name descname"><span class="pre">on_train_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.on_train_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.priority">
<span class="sig-name descname"><span class="pre">priority</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">99999</span></em><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.priority" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.renew">
<span class="sig-name descname"><span class="pre">renew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.renew" title="Permalink to this definition">¶</a></dt>
<dd><p>Renew when change stage(train/eval/test)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.LoggerCallback.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.LoggerCallback.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">RecordCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.log_matrix">
<span class="sig-name descname"><span class="pre">log_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.log_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.log_scalars">
<span class="sig-name descname"><span class="pre">log_scalars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.log_scalars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.log_text">
<span class="sig-name descname"><span class="pre">log_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.log_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.on_eval_end">
<span class="sig-name descname"><span class="pre">on_eval_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.on_eval_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.on_test_end">
<span class="sig-name descname"><span class="pre">on_test_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.on_test_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.on_train_epoch_end">
<span class="sig-name descname"><span class="pre">on_train_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.on_train_step_end">
<span class="sig-name descname"><span class="pre">on_train_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.on_train_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RecordCallback.only_main_process">
<span class="sig-name descname"><span class="pre">only_main_process</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#lumo.trainer.callbacks.RecordCallback.only_main_process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">RemoteCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.InitialCallback" title="lumo.trainer.callbacks.InitialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">InitialCallback</span></code></a>, <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.finished">
<span class="sig-name descname"><span class="pre">finished</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.finished" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.make_data">
<span class="sig-name descname"><span class="pre">make_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.make_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_eval_begin">
<span class="sig-name descname"><span class="pre">on_eval_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_eval_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_first_exception">
<span class="sig-name descname"><span class="pre">on_first_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_first_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>when an exception was raised in some function, on_exception() will be called.</p>
<p>如果异常发生在一个嵌套调用的函数中，那么该异常会在每一层函数都raise一次。</p>
<p>该方法将被调用当该异常第一次raise出来的时候。
该方法在 <strong>new</strong> 中作了处理逻辑，不受继承关系影响</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_imodels_end">
<span class="sig-name descname"><span class="pre">on_imodels_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_imodels_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_test_begin">
<span class="sig-name descname"><span class="pre">on_test_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_test_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_train_epoch_begin">
<span class="sig-name descname"><span class="pre">on_train_epoch_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_train_epoch_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.on_train_step_end">
<span class="sig-name descname"><span class="pre">on_train_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.on_train_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.only_main_process">
<span class="sig-name descname"><span class="pre">only_main_process</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.only_main_process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.RemoteCallback.request">
<span class="sig-name descname"><span class="pre">request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.RemoteCallback.request" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.ResourceRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">ResourceRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.ResourceRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a></p>
<p>Record CUDA GPU maximum memory used during training.</p>
<p>Results will be stored in two places:</p>
<ul class="simple">
<li><p>row_table.memory, see <code class="docutils literal notranslate"><span class="pre">RowTable</span></code> for details.</p></li>
<li><p>experiment.max_memory, see <code class="docutils literal notranslate"><span class="pre">Experiment.dump_info</span></code> for details.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.ResourceRecord.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.ResourceRecord.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.ResourceRecord.on_train_epoch_end">
<span class="sig-name descname"><span class="pre">on_train_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.ResourceRecord.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.SeedCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">SeedCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.SeedCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.InitialCallback" title="lumo.trainer.callbacks.InitialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">InitialCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.SeedCallback.on_imodels_begin">
<span class="sig-name descname"><span class="pre">on_imodels_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.SeedCallback.on_imodels_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.SkipWhenParamsEq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">SkipWhenParamsEq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.SkipWhenParamsEq" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a>, <a class="reference internal" href="#lumo.trainer.callbacks.InitialCallback" title="lumo.trainer.callbacks.InitialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">InitialCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.SkipWhenParamsEq.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.SkipWhenParamsEq.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.SkipWhenParamsEq.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.SkipWhenParamsEq.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.StopByCode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">StopByCode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.StopByCode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.TrainCallback" title="lumo.trainer.callbacks.TrainCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.StopByCode.on_train_step_end">
<span class="sig-name descname"><span class="pre">on_train_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.StopByCode.on_train_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TensorBoardCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">TensorBoardCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TensorBoardCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.RecordCallback" title="lumo.trainer.callbacks.RecordCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">RecordCallback</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TensorBoardCallback.log_matrix">
<span class="sig-name descname"><span class="pre">log_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TensorBoardCallback.log_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TensorBoardCallback.log_scalars">
<span class="sig-name descname"><span class="pre">log_scalars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TensorBoardCallback.log_scalars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TensorBoardCallback.log_text">
<span class="sig-name descname"><span class="pre">log_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TensorBoardCallback.log_text" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TensorBoardCallback.on_hooked">
<span class="sig-name descname"><span class="pre">on_hooked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TensorBoardCallback.on_hooked" title="Permalink to this definition">¶</a></dt>
<dd><p>called when callback hooked trainer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TensorBoardCallback.only_main_process">
<span class="sig-name descname"><span class="pre">only_main_process</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#lumo.trainer.callbacks.TensorBoardCallback.only_main_process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">TrainCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lumo.trainer.callbacks.BaseCallback" title="lumo.trainer.callbacks.BaseCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCallback</span></code></a></p>
<p>Abstract base class used to build new callbacks. Defined some methods used in train/eval/test loop.</p>
<p>Subclass TrainCallback if you want to control or add behavior before or after
- train/train_epoch/train_step
- eval/eval_epoch/eval_step
- test/test_epoch/test_step
- predict
- inference</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_eval_begin">
<span class="sig-name descname"><span class="pre">on_eval_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_eval_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_eval_end">
<span class="sig-name descname"><span class="pre">on_eval_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_eval_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_eval_step_begin">
<span class="sig-name descname"><span class="pre">on_eval_step_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_eval_step_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_eval_step_end">
<span class="sig-name descname"><span class="pre">on_eval_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_eval_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_inference_begin">
<span class="sig-name descname"><span class="pre">on_inference_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_inference_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_inference_end">
<span class="sig-name descname"><span class="pre">on_inference_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_inference_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_predict_begin">
<span class="sig-name descname"><span class="pre">on_predict_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_predict_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_predict_end">
<span class="sig-name descname"><span class="pre">on_predict_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_predict_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_test_begin">
<span class="sig-name descname"><span class="pre">on_test_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_test_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_test_end">
<span class="sig-name descname"><span class="pre">on_test_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_test_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_test_step_begin">
<span class="sig-name descname"><span class="pre">on_test_step_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_test_step_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_test_step_end">
<span class="sig-name descname"><span class="pre">on_test_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_test_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataLoaderType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arg_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_train_epoch_begin">
<span class="sig-name descname"><span class="pre">on_train_epoch_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_train_epoch_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_train_epoch_end">
<span class="sig-name descname"><span class="pre">on_train_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_train_step_begin">
<span class="sig-name descname"><span class="pre">on_train_step_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_train_step_begin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.TrainCallback.on_train_step_end">
<span class="sig-name descname"><span class="pre">on_train_step_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.trainer.Trainer" title="lumo.trainer.trainer.Trainer"><span class="pre">Trainer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ParamsType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">MetricType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.TrainCallback.on_train_step_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lumo.trainer.callbacks.map_func_name">
<span class="sig-prename descclassname"><span class="pre">lumo.trainer.callbacks.</span></span><span class="sig-name descname"><span class="pre">map_func_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.callbacks.map_func_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-lumo.trainer.components">
<span id="lumo-trainer-components-module"></span><h2>lumo.trainer.components module<a class="headerlink" href="#module-lumo.trainer.components" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerExperiment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.components.</span></span><span class="sig-name descname"><span class="pre">TrainerExperiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.components.TrainerExperiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lumo.exp.html#lumo.exp.experiment.SimpleExperiment" title="lumo.exp.experiment.SimpleExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleExperiment</span></code></a></p>
<p>A class for helping manage an experiment by Trainer.</p>
<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerExperiment.board_args">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">board_args</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerExperiment.board_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerExperiment.dump_train_eidx">
<span class="sig-name descname"><span class="pre">dump_train_eidx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eidx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.components.TrainerExperiment.dump_train_eidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Dumps the progress of the trainer.</p>
<p>Args:
eidx (int): The index of the current epoch (starting from 0).
epoch (int): The total number of epochs to train for.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerExperiment.log_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_dir</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerExperiment.log_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerExperiment.params_fn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">params_fn</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerExperiment.params_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerExperiment.state_dict_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_dict_dir</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerExperiment.state_dict_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerParams">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.components.</span></span><span class="sig-name descname"><span class="pre">TrainerParams</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lumo.core.html#lumo.core.params.Params" title="lumo.core.params.Params"><code class="xref py py-class docutils literal notranslate"><span class="pre">Params</span></code></a></p>
<p>A class to hold parameters for trainer.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerParams.INTERP">
<span class="sig-name descname"><span class="pre">INTERP</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerParams.INTERP" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#lumo.trainer.factory.InterpFactory" title="lumo.trainer.factory.InterpFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterpFactory</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerParams.OPTIM">
<span class="sig-name descname"><span class="pre">OPTIM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;lumo.trainer.factory._OptimFactory</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#lumo.trainer.components.TrainerParams.OPTIM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.components.TrainerParams.SCHE">
<span class="sig-name descname"><span class="pre">SCHE</span></span><a class="headerlink" href="#lumo.trainer.components.TrainerParams.SCHE" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#lumo.trainer.factory.InterpFactory" title="lumo.trainer.factory.InterpFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterpFactory</span></code></a></p>
</dd></dl>

</dd></dl>

</section>
<section id="module-lumo.trainer.factory">
<span id="lumo-trainer-factory-module"></span><h2>lumo.trainer.factory module<a class="headerlink" href="#module-lumo.trainer.factory" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.factory.</span></span><span class="sig-name descname"><span class="pre">InterpFactory</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A factory class for creating instances of various interpolation classes.</p>
<p>This class provides convenient access to various interpolation classes that are defined in the <code class="docutils literal notranslate"><span class="pre">interp</span></code> module.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Cos">
<span class="sig-name descname"><span class="pre">Cos</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Cos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for cosine interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Linear">
<span class="sig-name descname"><span class="pre">Linear</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Linear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for linear interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Exp">
<span class="sig-name descname"><span class="pre">Exp</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for exponential interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Log">
<span class="sig-name descname"><span class="pre">Log</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for logarithmic interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Constant">
<span class="sig-name descname"><span class="pre">Constant</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Constant" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for constant interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodCos">
<span class="sig-name descname"><span class="pre">PeriodCos</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodCos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for periodic cosine interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodHalfCos">
<span class="sig-name descname"><span class="pre">PeriodHalfCos</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodHalfCos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for periodic half-cosine interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodTriangle">
<span class="sig-name descname"><span class="pre">PeriodTriangle</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodTriangle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for periodic triangle interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodLinear">
<span class="sig-name descname"><span class="pre">PeriodLinear</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodLinear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for periodic linear interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PowerDecay">
<span class="sig-name descname"><span class="pre">PowerDecay</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PowerDecay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for power-decay interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.List">
<span class="sig-name descname"><span class="pre">List</span></span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.List" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>An interpolation class for list interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="id27">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id27" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCContinuous</span></code></p>
<p>A scheduler representing a constant value
|
constant    <a href="#id28"><span class="problematic" id="id29">|</span></a>————–
|
<a href="#id30"><span class="problematic" id="id31">|</span></a>________________
… any …</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id32">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id32" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCContinuous</span></code></p>
<p>one cycle cosine functoin</p>
<p>end -&gt;         ,———
/
start -&gt; ______/
↑   ↑
left right</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Cos.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Cos.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id33">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id33" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCContinuous</span></code></p>
<p>slow to quick</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Exp.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Exp.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id34">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id34" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCContinuous</span></code></p>
<p>linear schedule</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">^</span>
</pre></div>
</div>
<p>end     |               .*
|          .*
|     .*
<a href="#id35"><span class="problematic" id="id36">|</span></a>.*
start   +—————–&gt;
left            right</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Linear.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Linear.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">List</span></span><a class="headerlink" href="#id37" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="lumo.core.html#lumo.core.interp.InterpolateList" title="lumo.core.interp.InterpolateList"><code class="xref py py-class docutils literal notranslate"><span class="pre">InterpolateList</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id38">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id38" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCContinuous</span></code></p>
<p>quick to slow</p>
<p>end   |                              *
|                     *
|                *
|            *
|        *
|     *
|  *
start  <a href="#id39"><span class="problematic" id="id40">|</span></a>*
——————————————-
left                         right</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.Log.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.Log.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id41">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeriodCos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id41" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCPeriod</span></code></p>
<p>periodic cosine schedule</p>
<p>end -&gt;         ,-.     ,-.     ,-.     ,-.
/     /     /     /</p>
<p>start -&gt; <strong>**</strong>/     _/     _/     _/     _******__
ratio          0      1       2       3       …..
—-|
period</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodCos.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodCos.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id42">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeriodHalfCos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id42" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCPeriod</span></code></p>
<p>half periodic cosine schedule, period is (right-left)</p>
<p>end -&gt;         ,-  ,-  ,-  ,-
/   /   /   /
start -&gt; ______/   /   /   /
ratio         0   1   2   3   …
–|
period</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodHalfCos.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodHalfCos.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>interp with period halfcos method</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id43">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeriodLinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id43" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCPeriod</span></code></p>
<p>sawtooth wave, like a period line schedule
end            /    /    /    /
/    /    /    /
start      /    /    /    /
0    1    2    3     ….
—-|
period</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodLinear.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodLinear.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id44">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeriodTriangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id44" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABCPeriod</span></code></p>
<p>A interp class to simulate a periodic triangle waveform.</p>
<p>end         / / / /   start      /  /  /  /               0   1   2  3   4
–|
period</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.InterpFactory.PeriodTriangle.interp">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.InterpFactory.PeriodTriangle.interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation method for the schedule.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id45">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PowerDecay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id45" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Interpolate</span></code></p>
<p>equal to tf.train.exponential_decay, decay every &lt;decay_steps&gt; with a base of &lt;decay_rate&gt;</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.factory.OptimBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.factory.</span></span><span class="sig-name descname"><span class="pre">OptimBuilder</span></span><a class="headerlink" href="#lumo.trainer.factory.OptimBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="lumo.core.html#lumo.core.params.BaseParams" title="lumo.core.params.BaseParams"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseParams</span></code></a></p>
<p>A class for building an optimizer with specified parameters.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.factory.OptimBuilder.None">
<span class="sig-name descname"><span class="pre">None</span></span><a class="headerlink" href="#lumo.trainer.factory.OptimBuilder.None" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.OptimBuilder.from_kwargs">
<span class="sig-name descname"><span class="pre">from_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.factory.OptimBuilder.from_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Creates a new instance of OptimBuilder class and updates its attributes with the given keyword arguments.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.factory.OptimBuilder.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optimizer</span></span></span><a class="headerlink" href="#lumo.trainer.factory.OptimBuilder.build" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Builds and returns an optimizer with the specified parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optimizer</span></span></span><a class="headerlink" href="#id46" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds and returns an optimizer with the specified parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> – The parameters for the optimizer.</p></li>
<li><p><strong>optim_cls</strong> – The class of the optimizer to be built.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The built optimizer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optim_cls</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ModuleNotFoundError</strong> – If the specified optimizer class cannot be found in the corresponding module.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id47">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id47" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new instance of OptimBuilder class and updates its attributes with the given keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – <p>A dictionary containing the optimizer parameters.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new instance of the OptimBuilder class with updated attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-lumo.trainer.rnd">
<span id="lumo-trainer-rnd-module"></span><h2>lumo.trainer.rnd module<a class="headerlink" href="#module-lumo.trainer.rnd" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.rnd.RndManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.rnd.</span></span><span class="sig-name descname"><span class="pre">RndManager</span></span><a class="headerlink" href="#lumo.trainer.rnd.RndManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A seed manager for the trainer. Provides an interface for <code class="docutils literal notranslate"><span class="pre">~lumo.utils.random</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.rnd.RndManager.mark">
<span class="sig-name descname"><span class="pre">mark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.rnd.RndManager.mark" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes the random seed to a specific state for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>str</em><em>]</em>) – The name of the fixed seed state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.rnd.RndManager.shuffle">
<span class="sig-name descname"><span class="pre">shuffle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.rnd.RndManager.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Shuffles the random seed for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – The random seed to use. If None, a random seed based on the current</p></li>
<li><p><strong>used.</strong> (<em>time will be</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-lumo.trainer.saver">
<span id="lumo-trainer-saver-module"></span><h2>lumo.trainer.saver module<a class="headerlink" href="#module-lumo.trainer.saver" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.saver.</span></span><span class="sig-name descname"><span class="pre">Saver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Write state_dict into test dirs, record save log into /.lumo/save.&lt;exp_name&gt;.log</p>
<p>format:
&lt;test_name&gt; -&gt;</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>When save/load operations happend</strong><strong>, </strong><strong>you may meet Out Of Space</strong><strong>, </strong><strong>FileNotExist</strong><strong>, or </strong><strong>other problems</strong><strong>,</strong> – </p></li>
<li><p><strong>then Exception</strong><strong> or </strong><strong>its stack infomation will be printed in stderr</strong><strong> (</strong><strong>not be raised</strong><strong>)</strong><strong>, </strong><strong>and False/None value will be returned by</strong> – </p></li>
<li><p><strong>save_xx and load_xx functions.</strong> – </p></li>
<li><p><strong>You can handle these values and stop your program manully</strong><strong>, or </strong><strong>just let it go.</strong> – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.best_checkpoint">
<span class="sig-name descname"><span class="pre">best_checkpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.best_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the filename of the best checkpoint file if it exists, otherwise None.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The filename of the best checkpoint file if it exists, otherwise None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Union[None, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.best_model">
<span class="sig-name descname"><span class="pre">best_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.best_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the filename of the best model file if it exists, otherwise None.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.dump_state_dict">
<span class="sig-name descname"><span class="pre">dump_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.dump_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – picklable object</p></li>
<li><p><strong>fn</strong> – path-like object</p></li>
<li><p><strong>meta_info</strong> – meta infomation for the dumped object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>saved filepath, None if something went wrong.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.list">
<span class="sig-name descname"><span class="pre">list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sorted list of all filenames in the save directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.list_checkpoints">
<span class="sig-name descname"><span class="pre">list_checkpoints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.list_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sorted list of filenames of all checkpoint files in the save directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.list_keypoints">
<span class="sig-name descname"><span class="pre">list_keypoints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.list_keypoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sorted list of filenames of all keypoint files in the save directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.list_models">
<span class="sig-name descname"><span class="pre">list_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.list_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a sorted list of filenames of all model files in the save directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.load_checkpoint">
<span class="sig-name descname"><span class="pre">load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_if_exist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.load_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a checkpoint file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the checkpoint file in the list of checkpoints. Defaults to -1.</p></li>
<li><p><strong>best_if_exist</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, load the best checkpoint file. Defaults to False.</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em>) – The filename of the checkpoint file. Defaults to None.</p></li>
<li><p><strong>with_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the checkpoint file is expected to contain metadata. Defaults to False.</p></li>
<li><p><strong>map_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Where to load the checkpoint file. Defaults to ‘cpu’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None if the checkpoint file could not be loaded, otherwise the loaded checkpoint.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[None, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.load_keypoint">
<span class="sig-name descname"><span class="pre">load_keypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.load_keypoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a checkpoint file that is key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the keypoint file in the list of keypoints. Defaults to -1.</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em>) – The filename of the keypoint file. Defaults to None.</p></li>
<li><p><strong>with_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the keypoint file is expected to contain metadata. Defaults to False.</p></li>
<li><p><strong>map_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Where to load the keypoint file. Defaults to ‘cpu’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None if the keypoint file could not be loaded, otherwise the loaded keypoint.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[None, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.load_meta_info">
<span class="sig-name descname"><span class="pre">load_meta_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.load_meta_info" title="Permalink to this definition">¶</a></dt>
<dd><p>load
:param fn: pickled file path, not the metainfo file path(which ends with suffix ‘.json’).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>info object, or None if something went wrong.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_if_exist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a model file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the model file in the list of models. Defaults to -1.</p></li>
<li><p><strong>best_if_exist</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, load the best model file. Defaults to False.</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em>) – The filename of the model file. Defaults to None.</p></li>
<li><p><strong>with_meta</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the model file is expected to contain metadata. Defaults to False.</p></li>
<li><p><strong>map_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Where to load the model file. Defaults to ‘cpu’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None if the model file could not be loaded, otherwise the loaded model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[None, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_meta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#lumo.trainer.saver.state_dict_tuple" title="lumo.trainer.saver.state_dict_tuple"><span class="pre">state_dict_tuple</span></a></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> – pickled file path.</p></li>
<li><p><strong>with_meta</strong> – whether to get its meta infomation at the same time, default is False.</p></li>
<li><p><strong>map_location</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">res</span> <span class="pre">=</span> <span class="pre">load_state_dict(...)</span> <span class="pre">ckpt,</span> <span class="pre">info</span> <span class="pre">=</span> <span class="pre">res</span></code></p>
</dd>
</dl>
<p>or <code class="docutils literal notranslate"><span class="pre">ckpt</span></code> object will be returned alone.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if something went wrong, `ckpt` or `info` will be a None object.
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <code class="docutils literal notranslate"><span class="pre">with_meta=True</span></code>, a <code class="docutils literal notranslate"><span class="pre">state_dict_tuple</span></code> object will be returned, you can unpack this tuple directly</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.save_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>save a object as a deleteable</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> – progress indecator, using global_steps or epoch count is recommanded.</p></li>
<li><p><strong>state_dict</strong> – state dict</p></li>
<li><p><strong>meta_info</strong> – meta information for this state dict</p></li>
<li><p><strong>max_keep</strong> – </p></li>
<li><p><strong>is_best</strong> – Whether this checkpoint is currently best. If True, the best checkpoint</p></li>
</ul>
</dd>
</dl>
<p>file will be replaced by this one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Saved checpoint path, or None if something is wrong.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.save_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_dir</span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.save_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.save_keypoint">
<span class="sig-name descname"><span class="pre">save_keypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.save_keypoint" title="Permalink to this definition">¶</a></dt>
<dd><p>save a object which is keypoint.
:param steps:
:param state_dict:
:param meta_info:</p>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_best</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#lumo.trainer.saver.Saver.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>save model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>steps</strong> – progress indecator, using global_steps or epoch count is recommanded.</p></li>
<li><p><strong>state_dict</strong> – state dict</p></li>
<li><p><strong>meta_info</strong> – meta information for this state dict</p></li>
<li><p><strong>is_best</strong> – Whether this checkpoint is currently best. If True, the best checkpoint</p></li>
</ul>
</dd>
</dl>
<p>file will be replaced by this one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Saved checpoint path, or None if something is wrong.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.saver.Saver.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.Saver.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints a summary of the contents of the save directory.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.saver.state_dict_tuple">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.saver.</span></span><span class="sig-name descname"><span class="pre">state_dict_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.saver.state_dict_tuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that stores a state dictionary and corresponding meta information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – The state dictionary to be stored. Defaults to None.</p></li>
<li><p><strong>meta_info</strong> (<em>Any</em><em>, </em><em>optional</em>) – Any meta information to be stored. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.saver.state_dict_tuple.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><a class="headerlink" href="#lumo.trainer.saver.state_dict_tuple.state_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The stored state dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.saver.state_dict_tuple.meta_info">
<span class="sig-name descname"><span class="pre">meta_info</span></span><a class="headerlink" href="#lumo.trainer.saver.state_dict_tuple.meta_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>The stored meta information.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A state_dict_tuple instance.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IndexError</strong> – If the index is not 0 or 1.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<section id="create-an-instance-of-state-dict-tuple-with-state-dict-and-meta-info">
<h3>Create an instance of state_dict_tuple with state_dict and meta_info<a class="headerlink" href="#create-an-instance-of-state-dict-tuple-with-state-dict-and-meta-info" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p>sd = state_dict_tuple({‘a’: 1, ‘b’: 2}, ‘meta’)</p>
</div></blockquote>
</section>
<section id="access-the-state-dict-and-meta-info-using-the-operator">
<h3>Access the state_dict and meta_info using the [] operator<a class="headerlink" href="#access-the-state-dict-and-meta-info-using-the-operator" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p>sd[0]
{‘a’: 1, ‘b’: 2}
sd[1]
‘meta’</p>
</div></blockquote>
</section>
</dd></dl>

</section>
<section id="module-lumo.trainer.trainer">
<span id="lumo-trainer-trainer-module"></span><h2>lumo.trainer.trainer module<a class="headerlink" href="#module-lumo.trainer.trainer" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lumo.trainer.trainer.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_BaseTrainer</span></code></p>
<p>Trainer provides a complete training and evaluation logic to help users focus on specific training details.
It integrates logging, metric recording, experiment saving, version control, and complete callback control
of each life cycle.</p>
<p>When to use lumo.Trainer:</p>
<ul class="simple">
<li><p>At the beginning of the investigation direction, there will be many code branches and experiments</p></li>
</ul>
<p>based on the same set of data and models, but with different training details.
* Reproduce multiple papers in the same field, which are also based on the same dataset and evaluation logic.</p>
<p>When to simply use lumo.SimpleExperiment:</p>
<ul class="simple">
<li><p>You have maintained a mature training framework yourself, but there are still certain requirements</p></li>
</ul>
<p>for allocating dynamic(different) storage path and version control in each program.</p>
<p>At present, I have explored best practices based on lumo in two fields, this includs:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/pytorch-lumo/image-classification">https://github.com/pytorch-lumo/image-classification</a></p></li>
<li><p><a class="reference external" href="https://github.com/pytorch-lumo/MMERC">https://github.com/pytorch-lumo/MMERC</a></p></li>
</ul>
<p>Both two reposiroties are github templates and you can use them to create you new (private) repository.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.Meter">
<span class="sig-name descname"><span class="pre">Meter</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.Meter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new instance of the Meter class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new instance of the Meter class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="lumo.core.html#lumo.core.meter.Meter" title="lumo.core.meter.Meter">Meter</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.add_callback">
<span class="sig-name descname"><span class="pre">add_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a callback function. Note that duplicate callbacks are not recommended and not necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>callback</strong> – The callback function to add.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the callback was added successfully, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.callback_function">
<span class="sig-name descname"><span class="pre">callback_function</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'evaluate',</span> <span class="pre">'evaluate_step',</span> <span class="pre">'imodels',</span> <span class="pre">'process_loader',</span> <span class="pre">'regist_dataloader',</span> <span class="pre">'test',</span> <span class="pre">'test_step',</span> <span class="pre">'train',</span> <span class="pre">'train_epoch',</span> <span class="pre">'train_step'}</span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.callback_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.change_stage">
<span class="sig-name descname"><span class="pre">change_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.change_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the training stage to the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>stage</strong> (<a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><em>TrainStage</em></a>) – The value to change the training stage to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.create_record">
<span class="sig-name descname"><span class="pre">create_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.create_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new Record object with the specified TrainStage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stage</strong> (<a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><em>TrainStage</em></a><em>, </em><em>optional</em>) – The TrainStage to use for the new Record object. If not provided, the TrainStage</p></li>
<li><p><strong>used.</strong> (<em>from the Trainer object will be</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Record object with the specified TrainStage.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record">Record</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.database">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">database</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.database" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.datamodule">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">datamodule</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.datamodule" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the DataModule associated with this Trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The DataModule associated with this Trainer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule">DataModule</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.db">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">db</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the device used for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device used for training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.devices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">devices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">device</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.devices" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dictionary of devices used in the training session.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the devices used in the training session.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, torch.device]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.eidx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eidx</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.eidx" title="Permalink to this definition">¶</a></dt>
<dd><p>This value will be automatically incremented by 1 before calling the train_epoch method
current epoch round. The value remains unchanged in below methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.on_train_epoch_begin()</span></code>: eidx</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.train_step()</span></code>: eidx</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.on_train_epoch_end()</span></code>: eidx</p></li>
</ul>
<p>This behaviour of <code class="docutils literal notranslate"><span class="pre">.idx</span></code> and <code class="docutils literal notranslate"><span class="pre">.global_steps</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">.eidx</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the model on a given dataset and returns a <code class="docutils literal notranslate"><span class="pre">Record</span></code> object containing the evaluation results.
:param dm: A <code class="docutils literal notranslate"><span class="pre">DataModule</span></code> or <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> object for the dataset to evaluate on.
:type dm: Union[DataModule, DataLoader], optional
:param params: A dictionary containing hyperparameters for the evaluation.
:type params: ParamsType, optional
:param limit_step: An integer specifying the maximum number of batches to evaluate on.
:type limit_step: int, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">Record</span></code> object containing the evaluation results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.evaluate_step">
<span class="sig-name descname"><span class="pre">evaluate_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MetricType</span></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.evaluate_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a single evaluation step on a batch of data and returns a dictionary of evaluation metrics.
:param batch: A batch of data to evaluate on.
:param params: A dictionary containing hyperparameters for the evaluation step.
:type params: ParamsType, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of evaluation metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.first_epoch">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">first_epoch</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.first_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the current epoch is the first</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.first_step">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">first_step</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.first_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether the current step is the first</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.global_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">global_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.global_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>started from 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.icallbacks">
<span class="sig-name descname"><span class="pre">icallbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.icallbacks" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize callbacks in here</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.idx">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">idx</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.idx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.imodels">
<span class="sig-name descname"><span class="pre">imodels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.imodels" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize model in here</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.inference" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform inference on a batch of data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the Trainer object, update meta information in Experiment and TableRow.</p>
<p>If the Trainer object is already initialized, this method does nothing.</p>
<p>This function is auto called when start train()/test()/evaluate()</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.is_debug">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_debug</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.is_debug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.is_dist">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_dist</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.is_dist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.is_initialized">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_initialized</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.is_initialized" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this Trainer is initialized.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.is_main">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_main</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.is_main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.load_state_dict">
<span class="sig-name descname"><span class="pre">load_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.load_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Load state dictionary from a given dictionary.
:param state_dict: A dictionary containing the state dictionary to be loaded.
:type state_dict: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.local_rank">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">local_rank</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.local_rank" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.logger">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.logger" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.metrics">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.metrics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.model_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Module</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.model_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dictionary of model objects used in the training session.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the model objects used in the training session.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, nn.Module]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.model_state_dict">
<span class="sig-name descname"><span class="pre">model_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.model_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionary of the state of the models.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.numpy_tensor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">numpy_tensor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.numpy_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dictionary of NumPy array objects used in the training session.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the NumPy array objects used in the training session.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.on_trainer_exception">
<span class="sig-name descname"><span class="pre">on_trainer_exception</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.on_trainer_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates database with error information when an exception occurs during training.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.optim_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">optim_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optimizer</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.optim_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dictionary of optimizer objects used in the training session.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the optimizer objects used in the training session.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, Optimizer]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.optim_state_dict">
<span class="sig-name descname"><span class="pre">optim_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.optim_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionary of the state of the optimizers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.other_state_dict">
<span class="sig-name descname"><span class="pre">other_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.other_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionary of the state of the other objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.others">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">others</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.others" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of additional attributes stored in the Trainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dictionary of additional attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a prediction on a batch of data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.prepare_dataloader">
<span class="sig-name descname"><span class="pre">prepare_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoaderType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.prepare_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>automatically called before train()/test()/evaluate(), see <strong>new</strong> function of Trainer
:param loader:
:param stage:
:return:</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.process_loader">
<span class="sig-name descname"><span class="pre">process_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">TrainStage.train</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.process_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares and registers a dataloader with the given training stage to the current datamodule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>Union</em><em>[</em><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><em>DataModule</em></a><em>, </em><em>DataLoader</em><em>]</em><em>, </em><em>optional</em>) – The datamodule or dataloader to be processed. If not provided,</p></li>
<li><p><strong>exists.</strong> (<em>the current datamodule will be used if it</em>) – </p></li>
<li><p><strong>stage</strong> (<a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><em>TrainStage</em></a><em>, </em><em>optional</em>) – The training stage to which the dataloader will be associated. Defaults to TrainStage.train.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The prepared and registered dataloader.</p>
</dd>
</dl>
<p>None: If the dataloader cannot be prepared or registered.
:rtype: DataLoader</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.regist_dataloader">
<span class="sig-name descname"><span class="pre">regist_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.regist_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a dataloader with a given training stage to the current datamodule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> (<em>DataLoader</em>) – The dataloader to be registered.</p></li>
<li><p><strong>stage</strong> (<a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><em>TrainStage</em></a>) – The training stage to which the dataloader will be associated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.remove_callback">
<span class="sig-name descname"><span class="pre">remove_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.remove_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the given callback from the list of callbacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cur</strong> – The callback to remove.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.safe_writer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">safe_writer</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.safe_writer" title="Permalink to this definition">¶</a></dt>
<dd><p>see trainer.writer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.save_best_model">
<span class="sig-name descname"><span class="pre">save_best_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.save_best_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the best model checkpoint and metadata.</p>
<p>If the current process is the main process, saves the best model checkpoint as ‘best_model.ckpt’
and its metadata as ‘best_model.json’. If not, saves the checkpoint and metadata with the process rank
appended to the filename, e.g., ‘best_model-.ckpt’ and ‘best_model-.json’.</p>
<p>The saved metadata includes the global training steps and the value of the experiment’s best metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> – the Experiment object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.save_last_model">
<span class="sig-name descname"><span class="pre">save_last_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.save_last_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the last model checkpoint and metadata.</p>
<p>If the current process is the main process, saves the last model checkpoint as ‘last_model.ckpt’
and its metadata as ‘last_model.json’. If not, saves the checkpoint and metadata with the process rank
appended to the filename, e.g., ‘last_model-.ckpt’ and ‘last_model-.json’.</p>
<p>The saved metadata includes the global training steps and the value of the experiment’s best metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> – the Experiment object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.save_state_dict">
<span class="sig-name descname"><span class="pre">save_state_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest.pth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_main</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.save_state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current state dictionary to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the file to save the state dictionary to. Defaults to ‘latest.pth’.</p></li>
<li><p><strong>dirpath</strong> – The directory path to save the state dictionary file to. If None, defaults to the state dictionary</p></li>
</ul>
</dd>
</dl>
<p>directory of the Trainer’s experiment.
:param only_main: If True, saves the state dictionary to a single file. If False and the Trainer is distributed,
saves the state dictionary to multiple files, one for each process.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The path to the saved state dictionary file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.saver">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">saver</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.saver.Saver" title="lumo.trainer.saver.Saver"><span class="pre">Saver</span></a></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.saver" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.select_loader">
<span class="sig-name descname"><span class="pre">select_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.select_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects the appropriate loader based on the given data module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dm</strong> (<a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><em>DataModule</em></a><em> or </em><em>DataLoader</em><em> or </em><a class="reference internal" href="lumo.data.html#lumo.data.loader.DataLoaderSide" title="lumo.data.loader.DataLoaderSide"><em>DataLoaderSide</em></a><em>, </em><em>optional</em>) – The data module to use. Defaults to None.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The appropriate loader based on the given data module, or None if dm is None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataLoader or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.set_epoch_idx">
<span class="sig-name descname"><span class="pre">set_epoch_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.set_epoch_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the current epoch index to the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> – An integer representing the current epoch index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.set_global_steps">
<span class="sig-name descname"><span class="pre">set_global_steps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.set_global_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the global step count to the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> – An integer representing the global step count.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.set_idx">
<span class="sig-name descname"><span class="pre">set_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.set_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the current index to the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> – An integer representing the current index.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.set_property">
<span class="sig-name descname"><span class="pre">set_property</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.set_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a property with the given key to the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – A string representing the name of the property.</p></li>
<li><p><strong>value</strong> – The value to assign to the property.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.set_stage">
<span class="sig-name descname"><span class="pre">set_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.set_stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the training stage to the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>val</strong> (<a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><em>TrainStage</em></a>) – The value to set the training stage to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.state_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a dictionary of the state of the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.stop_train">
<span class="sig-name descname"><span class="pre">stop_train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.stop_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggle to stop train.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.stop_train_epoch">
<span class="sig-name descname"><span class="pre">stop_train_epoch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.stop_train_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggle to skip current train epoch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests the model on a given dataset and returns a <code class="docutils literal notranslate"><span class="pre">Record</span></code> object containing the evaluation results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dm</strong> (<em>Union</em><em>[</em><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><em>DataModule</em></a><em>, </em><em>DataLoader</em><em>]</em><em>, </em><em>optional</em>) – A <code class="docutils literal notranslate"><span class="pre">DataModule</span></code> or <code class="docutils literal notranslate"><span class="pre">DataLoader</span></code> object for the dataset to test on.</p></li>
<li><p><strong>params</strong> (<em>ParamsType</em><em>, </em><em>optional</em>) – A dictionary containing hyperparameters for the test.</p></li>
<li><p><strong>limit_step</strong> (<em>int</em><em>, </em><em>optional</em>) – An integer specifying the maximum number of batches to test on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">Record</span></code> object containing the evaluation results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.test_dataloader">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">test_dataloader</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataLoaderType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.test_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the DataLoader for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The DataLoader for the test data, or None if it is not available.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[DataLoaderType]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MetricType</span></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.test_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a single testing step on a batch of data and returns a dictionary of evaluation metrics.
:param batch: A batch of data to test on.
:param params: A dictionary containing hyperparameters for the testing step.
:type params: ParamsType, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of evaluation metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.to_device">
<span class="sig-name descname"><span class="pre">to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">device</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.to_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively sends the elements in a nested list/tuple/dictionary of tensors to a given device.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.torch_tensor">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">torch_tensor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.torch_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dictionary of PyTorch tensor objects used in the training session.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the PyTorch tensor objects used in the training session.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="lumo.data.html#lumo.data.datamodule.DataModule" title="lumo.data.datamodule.DataModule"><span class="pre">DataModule</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DataLoaderType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_global_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model using the specified data loader and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dm</strong> – The data loader or data module to use for training.</p>
</dd>
</dl>
<p>Defaults to self.train_dataloader.
:type dm: Union[DataModule, DataLoaderType], optional
:param params: The training parameters to use. Defaults to None.
:type params: ParamsType, optional
:param limit_global_steps: The maximum number of global steps to train for. Defaults to None.
:type limit_global_steps: int, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of training results.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dict[str, Any]</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If no data loader is available for training.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.train_dataloader">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train_dataloader</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataLoaderType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.train_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the DataLoader for the training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The DataLoader for the training data, or None if it is not available.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[DataLoaderType]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.train_epoch">
<span class="sig-name descname"><span class="pre">train_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoaderType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_global_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record"><span class="pre">Record</span></a></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.train_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model for one epoch using the specified data loader and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> (<em>DataLoaderType</em>) – The data loader to use for training.</p></li>
<li><p><strong>params</strong> (<em>ParamsType</em><em>, </em><em>optional</em>) – The training parameters to use. Defaults to None.</p></li>
<li><p><strong>limit_step</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of steps to train for. Defaults to None.</p></li>
<li><p><strong>limit_global_steps</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of global steps to train for. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A record of training results for the epoch.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="lumo.core.html#lumo.core.record.Record" title="lumo.core.record.Record">Record</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#lumo.trainer.components.TrainerParams" title="lumo.trainer.components.TrainerParams"><span class="pre">TrainerParams</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">MetricType</span></span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.train_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a single training step on a batch of data and returns a dictionary of training metrics.
:param batch: A batch of data to train on.
:param params: A dictionary containing hyperparameters for the training step.
:type params: ParamsType, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of training metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.trainer_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trainer_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.trainer_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state of the Trainer object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The state of the Trainer object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.trainstage">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trainstage</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="lumo.core.html#lumo.core.enums.TrainStage" title="lumo.core.enums.TrainStage"><span class="pre">TrainStage</span></a></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.trainstage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.val_dataloader">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">val_dataloader</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">DataLoaderType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#lumo.trainer.factory.OptimBuilder.None" title="lumo.trainer.factory.OptimBuilder.None"><span class="pre">None</span></a></em><a class="headerlink" href="#lumo.trainer.trainer.Trainer.val_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the DataLoader for the validation data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The DataLoader for the validation data, or None if it is not available.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[DataLoaderType]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.wait_for_everyone">
<span class="sig-name descname"><span class="pre">wait_for_everyone</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.wait_for_everyone" title="Permalink to this definition">¶</a></dt>
<dd><p>Will stop the execution of the current process until every other process has reached that point</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.world_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">world_size</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.world_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lumo.trainer.trainer.Trainer.writer">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">writer</span></span><a class="headerlink" href="#lumo.trainer.trainer.Trainer.writer" title="Permalink to this definition">¶</a></dt>
<dd><section id="notes">
<h3>Notes:<a class="headerlink" href="#notes" title="Permalink to this heading">¶</a></h3>
<p>When using add_embedding, there may raise some exceptions cased by version conflict, here is some solutions:</p>
<p>#. <code class="docutils literal notranslate"><span class="pre">tensorflow_core._api.v1.io.gfile</span></code> or <code class="docutils literal notranslate"><span class="pre">tensorflow_core._api.v2.io.gfile</span></code> has no attribute <code class="docutils literal notranslate"><span class="pre">get_filesystem</span></code>
first, try upgrade tensorboard and tensorflow as followed version:
tensorboard==2.0.2
tensorflow==2.0.0</p>
<p>If you still have the same problem, use this code as a temporary solution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">tensorboard</span> <span class="k">as</span> <span class="nn">tb</span>
<span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">gfile</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">tensorflow_stub</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">gfile</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">trainer.safe_writer</span></code> to get a writter with these code added inside thexp.</p>
<blockquote>
<div><p>This solution is referred by <a class="reference external" href="https://github.com/pytorch/pytorch/issues/30966">https://github.com/pytorch/pytorch/issues/30966</a> .</p>
</div></blockquote>
<p>#. You may cause PermissionError like: [Errno 13] Permission denied: ‘/tmp/.tensorboard-info/pid-20281.info’.
The solution is to set environment variable TMPDIRexport TMPDIR=/tmp/$USER;
mkdir -p $TMPDIR;
tensorboard –logdir …</p>
<p>One line command version:
export TMPDIR=/tmp/$USER; mkdir -p $TMPDIR; tensorboard –logdir ….</p>
<blockquote>
<div><p>This solution is referred by <a class="reference external" href="https://github.com/tensorflow/tensorboard/issues/2010">https://github.com/tensorflow/tensorboard/issues/2010</a> .</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A SummaryWriter instance</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-lumo.trainer">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lumo.trainer" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, sailist.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div>
    <p>True Flag</p>
    
    
    <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 1.0.0
      <span class="fa fa-caret-down"></span>
    </span>
        <div class="rst-other-versions">
            <dl>
                <dt>Versions</dt>
            </dl>
        </div>
    </div>
    

</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>